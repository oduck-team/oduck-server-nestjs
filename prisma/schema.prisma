generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Member {
  id            BigInt    @id @default(autoincrement())
  loginType     LoginType
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  deletedAt     DateTime?

  memberProfile MemberProfile?
  authSocial    AuthSocial?
  authPassword  AuthPassword?
  threads       Thread[]
  bookmarks     Bookmark[]
  reviewLikes   ReviewLike[]
}

model MemberProfile {
  id        BigInt    @id @default(autoincrement())
  memberId  BigInt    @unique
  name      String
  role      Role      @default(USER)
  imageUrl  String?
  point     BigInt    @default(0)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  member    Member    @relation(fields: [memberId], references: [id])
}

model AuthSocial {
  id        BigInt  @id @default(autoincrement())
  memberId  BigInt  @unique
  socialId  String
  type      String
  member    Member  @relation(fields: [memberId], references: [id])
}

model AuthPassword {
  id        BigInt    @id @default(autoincrement())
  memberId  BigInt    @unique
  hash      String
  password  String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  member    Member    @relation(fields: [memberId], references: [id])
}

model Animation {
  id                    BigInt    @id @default(autoincrement())
  name                  String
  plot                  String
  broadcastType         BroadcastType
  episodeNumber         Int       @default(0)
  rating                Rating
  primaryKeyword        String
  status                Status
  isReleased            Boolean   @default(false)
  reviewCount           Int       @default(0)
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  deletedAt             DateTime?

  animationGenres       AnimationGenre[]
  animationStudioList   AnimationStudio[]
  animationVoiceActors  AnimationVoiceActor[]
  originalWorkers       AnimationOriginalWorker[]
  images                AnimationImage[]
  keywords              Keyword[]
  seasons               Season[]
  bookmarks             Bookmark[]
}

model AnimationGenre {
  id          BigInt    @id @default(autoincrement())
  animationId BigInt
  genreId     BigInt

  animation   Animation @relation(fields: [animationId], references: [id])
  genre       Genre     @relation(fields: [genreId], references: [id])
}

model AnimationStudio {
  id          BigInt    @id @default(autoincrement())
  animationId BigInt
  studioId    BigInt

  animation   Animation @relation(fields: [animationId], references: [id])
  studio      Studio    @relation(fields: [studioId], references: [id])
}

model AnimationVoiceActor {
  id            BigInt      @id @default(autoincrement())
  animationId   BigInt
  voiceActorId  BigInt

  animation     Animation   @relation(fields: [animationId], references: [id])
  voiceActor    VoiceActor  @relation(fields: [voiceActorId], references: [id])
}

model AnimationOriginalWorker {
  id                BigInt          @id @default(autoincrement())
  animationId       BigInt
  originalWorkerId  BigInt

  animation         Animation       @relation(fields: [animationId], references: [id])
  originalWorker    OriginalWorker  @relation(fields: [originalWorkerId], references: [id])
}

model AnimationImage {
  id          BigInt    @id @default(autoincrement())
  animationId BigInt
  imageUrl    String
  createdAt   DateTime  @default(now())
  animation   Animation @relation(fields: [animationId], references: [id])
}

model Genre {
  id              BigInt    @id @default(autoincrement())
  type            GenreType
  createdAt       DateTime  @default(now())
  animationGenres AnimationGenre[]
}

model Studio {
  id                  BigInt    @id @default(autoincrement())
  name                String
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  animationStudioList AnimationStudio[]
}

model VoiceActor {
  id                    BigInt    @id @default(autoincrement())
  name                  String
  createdAt             DateTime  @default(now())
  animationVoiceActors  AnimationVoiceActor[]
}

model OriginalWorker {
  id                        BigInt    @id @default(autoincrement())
  name                      String
  createdAt                 DateTime  @default(now())
  animationOriginalWorkers  AnimationOriginalWorker[]
}

model Keyword {
  id          BigInt    @id @default(autoincrement())
  animationId BigInt
  keyword     String
  createdAt   DateTime  @default(now())
  animation   Animation @relation(fields: [animationId], references: [id])
}

model Season {
  id          BigInt    @id @default(autoincrement())
  animationId BigInt
  year        Int       @default(0)
  quarter     Int       @default(0)
  createdAt   DateTime  @default(now())
  animation   Animation @relation(fields: [animationId], references: [id])
}

model Review {
  id                BigInt    @id @default(autoincrement())
  memberId          BigInt
  animationId       BigInt
  type              ReviewType
  rating            Int       @default(0)
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  deletedAt         DateTime?

  shortReview       ShortReview?
  longReview        LongReview?
  attractionPoints  AttractionPoint[]
  reviewLikes       ReviewLike[]
}

model ShortReview {
  id        BigInt  @id @default(autoincrement())
  reviewId  BigInt  @unique
  comment   String
  review    Review  @relation(fields: [reviewId], references: [id])
}

model LongReview {
  id        BigInt  @id @default(autoincrement())
  reviewId  BigInt  @unique
  title     String
  content   String
  review    Review  @relation(fields: [reviewId], references: [id])
  images    LongReviewImage[]
}

model LongReviewImage {
  id            BigInt      @id @default(autoincrement())
  longReviewId  BigInt
  imageUrl      String
  createdAt     DateTime    @default(now())
  longReview    LongReview  @relation(fields: [longReviewId], references: [id])
}

model MemberPointLog {
  id          BigInt    @id @default(autoincrement())
  memberId    BigInt
  reasonCode  String
  reasonText  String
  createdAt   DateTime  @default(now())
}

model AttractionPoint {
  id                BigInt    @id @default(autoincrement())
  reviewId          BigInt
  attractionElement AttractionElement
  createdAt         DateTime  @default(now())
  review            Review    @relation(fields: [reviewId], references: [id])
}

model Thread {
  id        BigInt    @id @default(autoincrement())
  memberId  BigInt
  groupId   BigInt
  parentId  BigInt
  title     String
  comment   String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  member    Member    @relation(fields: [memberId], references: [id])
  images    ThreadImage[]
}

model ThreadImage {
  id        BigInt    @id @default(autoincrement())
  threadId  BigInt
  imageUrl  String
  createdAt DateTime  @default(now())
  thread    Thread    @relation(fields: [threadId], references: [id])
}

model Bookmark {
  id          BigInt    @id @default(autoincrement())
  memberId    BigInt
  animationId BigInt
  createdAt   DateTime  @default(now())

  member      Member    @relation(fields: [memberId], references: [id])
  animation   Animation @relation(fields: [animationId], references: [id])
}

model ReviewLike {
  id        BigInt    @id @default(autoincrement())
  memberId  BigInt
  reviewId  BigInt
  createdAt DateTime  @default(now())

  member    Member    @relation(fields: [memberId], references: [id])
  review    Review    @relation(fields: [reviewId], references: [id])
}

enum LoginType {
  LOCAL
  SOCIAL
}

enum Role {
  GUEST
  USER
  ADMIN
}

enum BroadcastType {
  TVA
  OVA
  THEATER
}

enum Rating {
  ADULT
  FIFTEEN
  TWELVE
  ALL
}

enum Status {
  FINISHED
  ONGOING
  UPCOMING
  UNKNOWN
}

enum GenreType {
  GENRE
}

enum ReviewType {
  SHORT
  LONG
}

enum AttractionElement {
  ATTRACTION
}